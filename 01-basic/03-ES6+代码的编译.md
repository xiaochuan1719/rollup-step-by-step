# 基于 ES6+ 语法代码的编译

## 本篇目标

- 创建项目 chapter02

- 编译 ES6+ 语法代码

- 编译成 `UMD` 格式（通用模块定义）


## 目标实现

### 1. 项目创建

```shell script
cd 01-basic-examples
mkdir chapter02
cd chapter02

yarn init -y

# rollup 核心模块
yarn add rollup -D

# rollup 编译 ES6+ 的Babel模块
yarn add rollup-plugin-babel @babel/core @babel/preset-env @babel/plugin-proposal-object-rest-spread -D
```

### 2. rollup.config.js

项目根目录下新建一个 build 目录，用于管理构建配置文件

```shell script
cd chapter01
mkdir build

# 在 build 目录下新建 rollup.config.js 文件
ni rollup.config.js
```

编写配置文件， ES6模块引用（import）方式编写

```javascript
import path from 'path'
import babel from 'rollup-plugin-babel'

const resolveFile = (filepath) => {
    return path.join(__dirname, '..', filepath)
}

export default {
    input: resolveFile('src/index.js'),
    output: {
        file: resolveFile('dist/index.js'),
        format: 'umd'
    },
    plugins: [
        babel({
            exclude: 'node_modules/**',
            presets: [
                [
                    '@babel/preset-env',
                    {
                        modules: false,
                        targets: {
                            chrome: '50',
                            ie: '9'
                        }
                    }
                ]
            ],
            plugins: ['@babel/plugin-proposal-object-rest-spread']
        })
    ]
}
```

在 `package.json` 配置文件中加入执行脚本

```javascript
// package.json
"scripts": {
    "build": "rollup -c ./build/rollup.config-import.js"
}
``` 


